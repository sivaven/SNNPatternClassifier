from brian import *
from time import time
eta=2.076338
ip_pattern_idx=[136,1,139,2,3,141,4,129,8,131,10,132,135,134,17,16,19,22,25,24,147,148,149,28,31,30,34,35,33,36,43,40,47,44,45,51,48,52,58,57,56,62,69,64,65,66,77,79,73,74,85,84,81,80,83,92,89,88,91,102,103,100,98,96,110,107,105,119,116,115,112,126,125,124,123]
spike_times_iter_ff3d=[[[20.0],[20.0],[20.0],[18.0],[13.0],[18.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[11.0],[19.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[15.0],[15.0],[14.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[10.0],[13.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[17.0],[17.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[12.0],[19.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[12.0],[19.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[13.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[12.0],[10.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[17.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[16.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[20.0],[15.0],[15.0],[8.0],[17.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[14.0],[9.0],[18.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[16.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[12.0],[19.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[13.0],[10.0],[19.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[15.0],[14.0],[19.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[10.0],[13.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[16.0],[13.0],[19.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[13.0],[9.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[12.0],[12.0],[10.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[17.0],[17.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[17.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[13.0],[13.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[9.0],[13.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[18.0],[13.0],[17.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[14.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[18.0],[9.0],[9.0],[13.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[14.0],[9.0],[18.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[20.0],[18.0],[18.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[15.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[11.0],[19.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[18.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[12.0],[19.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[10.0],[13.0],[19.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[17.0],[17.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[16.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[16.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[14.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[8.0],[16.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[15.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[17.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[9.0],[17.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[15.0],[15.0],[19.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[12.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[17.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[16.0],[20.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[9.0],[14.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[16.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[12.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[14.0],[19.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[12.0],[19.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[9.0],[17.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[18.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[15.0],[14.0],[19.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[16.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[14.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[17.0],[17.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[9.0],[15.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[18.0],[13.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[16.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[14.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[16.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[8.0],[15.0],[20.0],[18.0],[18.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[16.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[8.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[13.0],[10.0],[19.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[12.0],[10.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[14.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[15.0],[15.0],[14.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[11.0],[11.0],[11.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[18.0],[9.0],[9.0],[13.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[17.0],[13.0],[19.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[18.0],[9.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[16.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[17.0],[20.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[11.0],[19.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[15.0],[19.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[13.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[13.0],[10.0],[18.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[15.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[19.0],[12.0],[10.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[19.0],[14.0],[14.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[15.0],[8.0],[17.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[18.0],[18.0],[13.0],[18.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[17.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[16.0],[14.0],[19.0],[20.0],[20.0],[19.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[14.0],[9.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[14.0],[16.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[8.0],[16.0],[20.0],[18.0],[18.0],[16.0],[19.0],[20.0],[20.0],[20.0]],[[20.0],[16.0],[16.0],[14.0],[19.0],[20.0],[20.0],[20.0],[20.0],[18.0],[18.0],[16.0],[19.0],[20.0],[20.0],[20.0],[18.0],[9.0],[9.0],[13.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[13.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[17.0],[17.0],[16.0],[19.0],[20.0],[20.0],[20.0],[16.0],[8.0],[8.0],[16.0],[20.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[19.0],[13.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[19.0],[10.0],[10.0],[12.0],[19.0],[20.0],[20.0],[20.0],[19.0],[15.0],[15.0],[18.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[20.0],[20.0],[15.0],[14.0],[19.0],[20.0],[20.0],[20.0],[16.0],[16.0],[17.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[9.0],[17.0],[20.0],[17.0],[17.0],[16.0],[20.0],[20.0],[20.0],[20.0]],[[20.0],[19.0],[19.0],[13.0],[17.0],[20.0],[20.0],[20.0],[20.0],[16.0],[16.0],[16.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[20.0],[15.0],[8.0],[20.0],[18.0],[18.0],[15.0],[19.0],[20.0],[20.0],[20.0]]]
conn2_prob=0.3920475
stdp1_a_step=1.0
stdp_tau=500.0
stdp2_a_step=1.0
nw_arch=[32,61,99]
conn2_init_weight=8.0
spike_times_iter_stdp=[[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,199.0,219.0,240.0,258.0,280.0,299.0,319.0,340.0,360.0,380.0,399.0,420.0,440.0,460.0,480.0,499.0,520.0,539.0,560.0,579.0,600.0,619.0,640.0,660.0,679.0,698.0,720.0,740.0,759.0,780.0,799.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,959.0,978.0,999.0,1020.0,1040.0,1060.0,1080.0,1099.0,1120.0,1140.0,1159.0,1180.0,1200.0,1218.0,1240.0,1259.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[16.0,37.0,58.0,77.0,99.0,118.0,140.0,160.0,179.0,194.0,214.0,240.0,253.0,278.0,294.0,314.0,337.0,359.0,377.0,394.0,415.0,437.0,460.0,479.0,493.0,517.0,534.0,557.0,574.0,596.0,614.0,639.0,656.0,674.0,693.0,719.0,739.0,754.0,777.0,794.0,817.0,840.0,857.0,879.0,899.0,917.0,937.0,953.0,973.0,994.0,1017.0,1036.0,1059.0,1079.0,1094.0,1119.0,1136.0,1154.0,1180.0,1195.0,1213.0,1239.0,1254.0,1276.0,1300.0,1319.0,1338.0,1359.0,1378.0,1395.0,1418.0,1439.0,1459.0,1478.0,1497.0],[16.0,37.0,58.0,77.0,99.0,118.0,140.0,160.0,179.0,194.0,214.0,240.0,253.0,278.0,294.0,314.0,337.0,359.0,377.0,394.0,415.0,437.0,460.0,479.0,493.0,517.0,534.0,557.0,574.0,596.0,614.0,639.0,656.0,674.0,693.0,719.0,739.0,754.0,777.0,794.0,817.0,840.0,857.0,879.0,899.0,917.0,937.0,953.0,973.0,994.0,1017.0,1036.0,1059.0,1079.0,1094.0,1119.0,1136.0,1154.0,1180.0,1195.0,1213.0,1239.0,1254.0,1276.0,1300.0,1319.0,1338.0,1359.0,1378.0,1395.0,1418.0,1439.0,1459.0,1478.0,1497.0],[13.0,33.0,53.0,73.0,94.0,113.0,138.0,156.0,174.0,195.0,215.0,237.0,257.0,273.0,296.0,315.0,333.0,354.0,373.0,395.0,414.0,433.0,458.0,474.0,497.0,513.0,535.0,553.0,575.0,593.0,615.0,633.0,653.0,675.0,697.0,713.0,735.0,755.0,773.0,795.0,813.0,835.0,853.0,874.0,893.0,913.0,933.0,956.0,977.0,995.0,1013.0,1034.0,1053.0,1075.0,1096.0,1114.0,1133.0,1155.0,1175.0,1194.0,1218.0,1234.0,1255.0,1274.0,1298.0,1314.0,1333.0,1353.0,1373.0,1394.0,1413.0,1433.0,1453.0,1473.0,1493.0],[19.0,38.0,57.0,78.0,95.0,117.0,133.0,153.0,175.0,199.0,220.0,233.0,260.0,277.0,300.0,320.0,338.0,356.0,378.0,400.0,419.0,438.0,453.0,475.0,500.0,518.0,540.0,558.0,580.0,599.0,620.0,636.0,659.0,679.0,700.0,716.0,735.0,760.0,778.0,799.0,818.0,834.0,858.0,875.0,897.0,918.0,938.0,960.0,980.0,999.0,1018.0,1039.0,1057.0,1075.0,1100.0,1115.0,1139.0,1159.0,1174.0,1199.0,1220.0,1235.0,1260.0,1279.0,1293.0,1316.0,1338.0,1357.0,1377.0,1399.0,1418.0,1437.0,1456.0,1477.0,1498.0],[20.0,40.0,60.0,80.0,100.0,120.0,137.0,159.0,180.0,200.0,220.0,238.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,457.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,739.0,760.0,780.0,800.0,820.0,839.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1079.0,1100.0,1120.0,1140.0,1160.0,1179.0,1200.0,1220.0,1240.0,1260.0,1280.0,1297.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[19.0,39.0,59.0,80.0,99.0,119.0,140.0,160.0,179.0,200.0,219.0,239.0,259.0,279.0,300.0,320.0,340.0,359.0,379.0,398.0,419.0,439.0,459.0,479.0,500.0,520.0,540.0,559.0,579.0,599.0,620.0,639.0,659.0,680.0,699.0,720.0,739.0,760.0,779.0,800.0,819.0,840.0,859.0,880.0,899.0,920.0,939.0,960.0,980.0,1000.0,1019.0,1040.0,1059.0,1080.0,1099.0,1120.0,1139.0,1160.0,1180.0,1200.0,1219.0,1240.0,1260.0,1280.0,1299.0,1319.0,1339.0,1359.0,1379.0,1400.0,1419.0,1439.0,1459.0,1479.0,1499.0],[16.0,36.0,56.0,78.0,96.0,116.0,137.0,157.0,175.0,197.0,215.0,236.0,255.0,275.0,297.0,316.0,338.0,356.0,376.0,395.0,416.0,436.0,456.0,476.0,497.0,517.0,537.0,556.0,575.0,596.0,616.0,636.0,655.0,677.0,696.0,716.0,736.0,757.0,776.0,797.0,816.0,836.0,856.0,876.0,895.0,916.0,936.0,956.0,976.0,997.0,1015.0,1037.0,1056.0,1076.0,1096.0,1116.0,1136.0,1156.0,1176.0,1197.0,1216.0,1236.0,1256.0,1278.0,1296.0,1316.0,1336.0,1355.0,1376.0,1398.0,1416.0,1435.0,1456.0,1476.0,1496.0],[16.0,36.0,56.0,78.0,96.0,116.0,137.0,157.0,175.0,197.0,215.0,236.0,255.0,275.0,297.0,316.0,338.0,356.0,376.0,395.0,416.0,436.0,456.0,476.0,497.0,517.0,537.0,556.0,575.0,596.0,616.0,636.0,655.0,677.0,696.0,716.0,736.0,757.0,776.0,797.0,816.0,836.0,856.0,876.0,895.0,916.0,936.0,956.0,976.0,997.0,1015.0,1037.0,1056.0,1076.0,1096.0,1116.0,1136.0,1156.0,1176.0,1197.0,1216.0,1236.0,1256.0,1278.0,1296.0,1316.0,1336.0,1355.0,1376.0,1398.0,1416.0,1435.0,1456.0,1476.0,1496.0],[18.0,37.0,57.0,75.0,97.0,117.0,136.0,156.0,178.0,196.0,218.0,237.0,258.0,278.0,296.0,317.0,335.0,357.0,377.0,398.0,417.0,437.0,457.0,477.0,496.0,516.0,536.0,557.0,578.0,597.0,617.0,637.0,658.0,676.0,697.0,717.0,737.0,756.0,777.0,796.0,817.0,836.0,857.0,876.0,898.0,916.0,937.0,956.0,976.0,996.0,1018.0,1036.0,1057.0,1076.0,1097.0,1117.0,1137.0,1156.0,1176.0,1196.0,1217.0,1237.0,1256.0,1276.0,1298.0,1317.0,1337.0,1358.0,1377.0,1395.0,1417.0,1438.0,1457.0,1477.0,1497.0],[20.0,40.0,60.0,79.0,100.0,120.0,139.0,159.0,180.0,199.0,220.0,240.0,260.0,280.0,300.0,320.0,339.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,519.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,679.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,999.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1199.0,1220.0,1240.0,1260.0,1279.0,1300.0,1320.0,1340.0,1360.0,1380.0,1399.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,78.0,100.0,120.0,140.0,160.0,180.0,199.0,220.0,240.0,258.0,280.0,299.0,319.0,339.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,499.0,520.0,539.0,560.0,580.0,600.0,619.0,640.0,660.0,679.0,698.0,720.0,740.0,759.0,780.0,799.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,959.0,978.0,999.0,1020.0,1040.0,1060.0,1080.0,1099.0,1120.0,1140.0,1160.0,1180.0,1199.0,1217.0,1240.0,1259.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1399.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,69.0,100.0,120.0,140.0,160.0,180.0,190.0,220.0,240.0,249.0,280.0,292.0,311.0,331.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,490.0,513.0,532.0,560.0,580.0,600.0,611.0,640.0,660.0,672.0,689.0,720.0,740.0,751.0,780.0,791.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,952.0,969.0,991.0,1020.0,1033.0,1060.0,1080.0,1090.0,1120.0,1140.0,1153.0,1180.0,1191.0,1208.0,1240.0,1250.0,1273.0,1300.0,1320.0,1340.0,1360.0,1380.0,1391.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,69.0,100.0,120.0,140.0,160.0,180.0,190.0,220.0,240.0,249.0,280.0,292.0,311.0,331.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,490.0,513.0,532.0,560.0,580.0,600.0,611.0,640.0,660.0,672.0,689.0,720.0,740.0,751.0,780.0,791.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,952.0,969.0,991.0,1020.0,1033.0,1060.0,1080.0,1090.0,1120.0,1140.0,1153.0,1180.0,1191.0,1208.0,1240.0,1250.0,1273.0,1300.0,1320.0,1340.0,1360.0,1380.0,1391.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,74.0,100.0,120.0,140.0,160.0,180.0,192.0,218.0,240.0,253.0,280.0,290.0,311.0,331.0,360.0,380.0,399.0,420.0,440.0,460.0,480.0,492.0,509.0,530.0,560.0,580.0,600.0,611.0,640.0,660.0,670.0,693.0,720.0,740.0,751.0,780.0,791.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,950.0,973.0,991.0,1020.0,1029.0,1060.0,1080.0,1092.0,1120.0,1140.0,1149.0,1180.0,1191.0,1215.0,1240.0,1252.0,1269.0,1300.0,1320.0,1340.0,1360.0,1380.0,1391.0,1420.0,1440.0,1460.0,1480.0,1500.0],[18.0,37.0,58.0,80.0,98.0,119.0,140.0,160.0,180.0,199.0,209.0,240.0,260.0,279.0,299.0,319.0,339.0,360.0,380.0,391.0,415.0,437.0,460.0,480.0,499.0,518.0,539.0,560.0,579.0,600.0,619.0,640.0,656.0,679.0,700.0,720.0,740.0,759.0,777.0,799.0,815.0,839.0,860.0,880.0,900.0,920.0,939.0,959.0,980.0,999.0,1020.0,1038.0,1060.0,1080.0,1099.0,1120.0,1137.0,1158.0,1180.0,1199.0,1220.0,1239.0,1259.0,1278.0,1300.0,1319.0,1340.0,1360.0,1376.0,1399.0,1419.0,1438.0,1460.0,1480.0,1497.0],[10.0,28.0,49.0,80.0,90.0,113.0,140.0,160.0,180.0,200.0,214.0,240.0,260.0,271.0,300.0,320.0,340.0,360.0,376.0,392.0,409.0,428.0,460.0,477.0,500.0,520.0,540.0,556.0,571.0,595.0,620.0,639.0,648.0,680.0,700.0,719.0,734.0,760.0,769.0,800.0,809.0,833.0,856.0,879.0,896.0,914.0,931.0,960.0,980.0,1000.0,1016.0,1040.0,1056.0,1080.0,1100.0,1119.0,1129.0,1160.0,1179.0,1200.0,1220.0,1233.0,1260.0,1280.0,1300.0,1312.0,1334.0,1355.0,1368.0,1400.0,1411.0,1430.0,1458.0,1475.0,1489.0],[13.0,36.0,54.0,80.0,93.0,110.0,139.0,156.0,173.0,200.0,220.0,236.0,260.0,272.0,300.0,320.0,340.0,353.0,368.0,399.0,417.0,436.0,459.0,468.0,500.0,520.0,540.0,548.0,572.0,589.0,620.0,631.0,657.0,680.0,700.0,710.0,729.0,760.0,775.0,800.0,817.0,830.0,848.0,872.0,888.0,909.0,932.0,960.0,980.0,1000.0,1008.0,1040.0,1048.0,1074.0,1100.0,1111.0,1135.0,1160.0,1172.0,1200.0,1220.0,1230.0,1260.0,1280.0,1300.0,1311.0,1329.0,1349.0,1377.0,1400.0,1412.0,1433.0,1449.0,1469.0,1495.0],[19.0,40.0,60.0,80.0,99.0,119.0,132.0,148.0,169.0,200.0,220.0,228.0,260.0,279.0,300.0,320.0,340.0,349.0,376.0,400.0,420.0,440.0,452.0,475.0,500.0,520.0,540.0,556.0,579.0,597.0,620.0,631.0,660.0,680.0,700.0,712.0,738.0,760.0,780.0,800.0,820.0,839.0,856.0,870.0,897.0,918.0,939.0,960.0,980.0,1000.0,1017.0,1040.0,1056.0,1069.0,1100.0,1111.0,1140.0,1160.0,1170.0,1200.0,1220.0,1239.0,1260.0,1280.0,1294.0,1319.0,1338.0,1357.0,1380.0,1400.0,1419.0,1439.0,1454.0,1477.0,1500.0],[20.0,39.0,60.0,79.0,100.0,120.0,140.0,160.0,180.0,199.0,219.0,240.0,259.0,280.0,299.0,318.0,339.0,360.0,380.0,399.0,420.0,440.0,460.0,480.0,499.0,519.0,539.0,560.0,580.0,600.0,618.0,640.0,660.0,679.0,699.0,720.0,740.0,759.0,780.0,799.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,959.0,979.0,999.0,1020.0,1039.0,1060.0,1080.0,1098.0,1120.0,1140.0,1159.0,1180.0,1199.0,1218.0,1240.0,1259.0,1279.0,1300.0,1320.0,1340.0,1360.0,1380.0,1398.0,1420.0,1440.0,1460.0,1480.0,1500.0],[16.0,36.0,56.0,75.0,96.0,116.0,138.0,158.0,177.0,195.0,216.0,237.0,255.0,277.0,295.0,315.0,335.0,358.0,378.0,396.0,416.0,436.0,458.0,478.0,495.0,515.0,535.0,557.0,577.0,598.0,615.0,638.0,656.0,675.0,695.0,717.0,736.0,755.0,777.0,795.0,816.0,836.0,857.0,878.0,897.0,917.0,936.0,955.0,975.0,995.0,1018.0,1035.0,1057.0,1078.0,1095.0,1118.0,1136.0,1155.0,1178.0,1195.0,1215.0,1237.0,1255.0,1275.0,1298.0,1317.0,1337.0,1357.0,1376.0,1395.0,1417.0,1436.0,1457.0,1477.0,1496.0],[16.0,36.0,56.0,75.0,96.0,116.0,138.0,158.0,177.0,195.0,216.0,237.0,255.0,277.0,295.0,315.0,335.0,358.0,378.0,396.0,416.0,436.0,458.0,478.0,495.0,515.0,535.0,557.0,577.0,598.0,615.0,638.0,656.0,675.0,695.0,717.0,736.0,755.0,777.0,795.0,816.0,836.0,857.0,878.0,897.0,917.0,936.0,955.0,975.0,995.0,1018.0,1035.0,1057.0,1078.0,1095.0,1118.0,1136.0,1155.0,1178.0,1195.0,1215.0,1237.0,1255.0,1275.0,1298.0,1317.0,1337.0,1357.0,1376.0,1395.0,1417.0,1436.0,1457.0,1477.0,1496.0],[17.0,37.0,56.0,78.0,96.0,116.0,135.0,155.0,176.0,198.0,217.0,236.0,258.0,276.0,298.0,318.0,338.0,355.0,375.0,397.0,416.0,436.0,456.0,475.0,498.0,518.0,538.0,556.0,576.0,596.0,618.0,635.0,656.0,678.0,698.0,716.0,736.0,758.0,776.0,798.0,817.0,836.0,856.0,875.0,896.0,916.0,936.0,958.0,978.0,998.0,1016.0,1038.0,1056.0,1075.0,1098.0,1115.0,1136.0,1158.0,1175.0,1198.0,1218.0,1236.0,1258.0,1278.0,1295.0,1316.0,1336.0,1356.0,1376.0,1398.0,1416.0,1436.0,1456.0,1476.0,1497.0],[20.0,40.0,60.0,80.0,100.0,120.0,139.0,159.0,179.0,200.0,220.0,239.0,260.0,280.0,300.0,320.0,340.0,359.0,379.0,400.0,420.0,440.0,459.0,479.0,500.0,520.0,540.0,559.0,579.0,599.0,620.0,639.0,660.0,680.0,700.0,719.0,740.0,760.0,780.0,800.0,820.0,840.0,859.0,879.0,899.0,919.0,940.0,960.0,980.0,1000.0,1019.0,1040.0,1060.0,1079.0,1100.0,1119.0,1140.0,1160.0,1179.0,1200.0,1220.0,1240.0,1260.0,1280.0,1299.0,1320.0,1339.0,1360.0,1380.0,1400.0,1420.0,1440.0,1459.0,1479.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0],[20.0,40.0,60.0,80.0,100.0,120.0,140.0,160.0,180.0,200.0,220.0,240.0,260.0,280.0,300.0,320.0,340.0,360.0,380.0,400.0,420.0,440.0,460.0,480.0,500.0,520.0,540.0,560.0,580.0,600.0,620.0,640.0,660.0,680.0,700.0,720.0,740.0,760.0,780.0,800.0,820.0,840.0,860.0,880.0,900.0,920.0,940.0,960.0,980.0,1000.0,1020.0,1040.0,1060.0,1080.0,1100.0,1120.0,1140.0,1160.0,1180.0,1200.0,1220.0,1240.0,1260.0,1280.0,1300.0,1320.0,1340.0,1360.0,1380.0,1400.0,1420.0,1440.0,1460.0,1480.0,1500.0]]
dt_=1.0
conn1_init_weight=9.0
stdp_gmax=10.0
sim_dur_ff=50.0
sim_dur_stdp=1500.0
conn1_prob=0.5762958
#
#

k=0.571/ms/mV
a=0.13
b=-2.714
d=111.506
C=81.2
vR=-60.5*mV
vT=-34.8*mV
vPeak=42.4*mV
c=-60.0*mV
Is=0

model9pEqs= Equations('''
		dV/dt=(k*((V-vR)*(V-vT))-U+I)/(C) : volt
		dU/dt=a*((b*(V-vR)/ms/ms)-(U/ms)) : volt/second
		I : mV/ms
		''')

eqs_stdp='''
dA_pre/dt=-A_pre/tau : 1
dA_post/dt=-A_post/tau : 1
'''

simclock = Clock(dt=dt_*ms)
spikeTimes = [(i, t*ms) for i in xrange(len(spike_times_iter_stdp)) for t in spike_times_iter_stdp[i]]

inputLayer = SpikeGeneratorGroup(nw_arch[0], spikeTimes, clock=simclock)
hiddenLayer = NeuronGroup(nw_arch[1], model=model9pEqs, threshold="V>vPeak", reset="V=c;U+=d", method= "RK", clock=simclock)
outputLayer = NeuronGroup(nw_arch[2], model=model9pEqs, threshold="V>vPeak", reset="V=c;U+=d", method= "RK", clock=simclock)
hiddenLayer.V = vR 
hiddenLayer.U =0
outputLayer.V = vR 
outputLayer.U =0

conn1 = Connection(inputLayer, hiddenLayer, 'V', weight=conn1_init_weight*mV, sparseness=conn1_prob)
conn2 = Connection(hiddenLayer, outputLayer, 'V', weight=conn2_init_weight*mV, sparseness=conn2_prob)
tau = stdp_tau*ms
stdp1=STDP(conn1,eqs=eqs_stdp,pre='A_pre+=stdp1_a_step*mV;w+=A_post*eta',post='A_post+=stdp1_a_step*mV;w+=A_pre*eta',wmax=stdp_gmax*mV, clock=simclock)
stdp2=STDP(conn2,eqs=eqs_stdp,pre='A_pre+=stdp2_a_step*mV;w+=A_post*eta',post='A_post+=stdp2_a_step*mV;w+=A_pre*eta',wmax=stdp_gmax*mV, clock=simclock)
Mpr = PopulationRateMonitor(outputLayer, bin=1*ms)

run(sim_dur_stdp*ms)

#
#
def feed_forward(spikeTimesIterList, ipPatternIdx):
	reinit(states=False)
	spikeTimes = [(i, t*ms) for i in xrange(len(spikeTimesIterList)) for t in spikeTimesIterList[i]]
	inputLayer.spiketimes=spikeTimes
	t1 = time()
	run(sim_dur_ff*ms)
	t2 = time()
	print "#$ip_pattern_idx:", ipPatternIdx
	print "$sim_time:", t2 - t1, "s"
	print "$op_layer_pop_rates:"," ".join(str(p) for p in Mpr.rate)


stdp1 = None
stdp2=None
hiddenLayer.V = vR 
hiddenLayer.U =0
outputLayer.V = vR 
outputLayer.U =0
for i in xrange(0, len(spike_times_iter_ff3d)):
	feed_forward(spikeTimesIterList = spike_times_iter_ff3d[i], ipPatternIdx = ip_pattern_idx[i])
