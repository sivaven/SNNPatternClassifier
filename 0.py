from brian import *
from time import time
conn2_prob=0.90344477
ip_pattern_idx=[137,1,138,141,140,143,6,7,8,129,11,133,132,135,134,16,21,23,22,25,24,27,146,147,26,28,32,33,36,37,43,41,46,47,44,51,49,48,55,54,53,52,59,58,57,62,61,60,68,64,65,67,76,72,73,85,84,81,82,93,94,102,101,96,109,106,104,118,116,114,112,127,126,124,121]
stdp2_a_step=0.10061691
conn1_init_weight=3.6461256
conn1_prob=0.7567879
nw_arch=[32,69,69]
conn2_init_weight=1.7008046
stdp_tau=375.65887
dt_=1.0
spike_times_iter_ff3d=[[[10000.0],[10000.0],[10000.0],[13.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[12.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[9.0],[18.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[16.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[15.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[9.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[13.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[18.0],[13.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[13.0],[9.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[12.0],[10.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[16.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[13.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[18.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[9.0],[9.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[13.0],[13.0],[9.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[13.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[8.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[12.0],[10.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[8.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[15.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[17.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[8.0],[15.0],[10000.0],[18.0],[18.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[12.0],[10.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[15.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[15.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[9.0],[9.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[12.0],[10.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[18.0],[13.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[9.0],[9.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[12.0],[10.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[13.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[8.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[13.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[10.0],[12.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[15.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[11.0],[11.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[11.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[17.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[15.0],[15.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[11.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[9.0],[14.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[17.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[9.0],[15.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[11.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[10.0],[13.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[8.0],[16.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[15.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[9.0],[18.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[13.0],[10.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[13.0],[10.0],[18.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[18.0],[9.0],[14.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[9.0],[15.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[16.0],[14.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[9.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[16.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[9.0],[15.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[14.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[15.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[11.0],[12.0],[10000.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[13.0],[9.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[12.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[17.0],[17.0],[13.0],[18.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[8.0],[16.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[15.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10.0],[12.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[18.0],[18.0],[13.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[14.0],[9.0],[18.0],[10000.0],[17.0],[17.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[10000.0],[10000.0],[14.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[12.0],[10.0],[10000.0],[18.0],[18.0],[15.0],[10000.0],[10000.0],[10000.0],[10000.0]],[[10000.0],[16.0],[16.0],[13.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[16.0],[16.0],[17.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[10000.0],[15.0],[9.0],[17.0],[10000.0],[18.0],[18.0],[16.0],[10000.0],[10000.0],[10000.0],[10000.0]]]
stdp1_a_step=0.19992998
sim_dur_stdp=1500.0
spike_times_iter_stdp=[[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,558.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,1238.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,1378.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[16.0,36.0,54.0,10060.0,10080.0,10100.0,10120.0,158.0,176.0,194.0,10200.0,233.0,254.0,10260.0,10280.0,314.0,337.0,10340.0,10360.0,10380.0,10400.0,434.0,10440.0,10460.0,10480.0,518.0,538.0,553.0,576.0,597.0,10600.0,10620.0,657.0,10660.0,694.0,717.0,737.0,758.0,10760.0,10780.0,814.0,837.0,856.0,877.0,894.0,918.0,10920.0,956.0,974.0,10980.0,1013.0,1036.0,1054.0,11060.0,1096.0,1117.0,1134.0,11140.0,1174.0,1198.0,1216.0,1233.0,1257.0,1278.0,1296.0,11300.0,1333.0,1354.0,1373.0,11380.0,1418.0,11420.0,11440.0,1477.0,1497.0],[16.0,36.0,54.0,10060.0,10080.0,10100.0,10120.0,158.0,176.0,194.0,10200.0,233.0,254.0,10260.0,10280.0,314.0,337.0,10340.0,10360.0,10380.0,10400.0,434.0,10440.0,10460.0,10480.0,518.0,538.0,553.0,576.0,597.0,10600.0,10620.0,657.0,10660.0,694.0,717.0,737.0,758.0,10760.0,10780.0,814.0,837.0,856.0,877.0,894.0,918.0,10920.0,956.0,974.0,10980.0,1013.0,1036.0,1054.0,11060.0,1096.0,1117.0,1134.0,11140.0,1174.0,1198.0,1216.0,1233.0,1257.0,1278.0,1296.0,11300.0,1333.0,1354.0,1373.0,11380.0,1418.0,11420.0,11440.0,1477.0,1497.0],[13.0,33.0,55.0,73.0,94.0,118.0,137.0,153.0,173.0,195.0,213.0,236.0,256.0,274.0,295.0,315.0,333.0,353.0,378.0,394.0,413.0,435.0,454.0,473.0,493.0,513.0,533.0,557.0,573.0,593.0,613.0,638.0,653.0,675.0,695.0,713.0,733.0,753.0,774.0,793.0,816.0,833.0,854.0,873.0,895.0,913.0,933.0,954.0,975.0,996.0,1017.0,1034.0,1056.0,1074.0,1093.0,1113.0,1135.0,1155.0,1175.0,1193.0,1214.0,1238.0,1253.0,1273.0,1293.0,1318.0,1336.0,1355.0,1377.0,1393.0,1413.0,1434.0,1457.0,1473.0,1493.0],[10000.0,10020.0,10040.0,77.0,95.0,113.0,133.0,157.0,10160.0,10180.0,216.0,10220.0,10240.0,275.0,294.0,10300.0,338.0,357.0,373.0,396.0,416.0,10420.0,455.0,477.0,496.0,518.0,537.0,10540.0,10560.0,598.0,617.0,633.0,658.0,674.0,10680.0,718.0,738.0,757.0,775.0,797.0,10800.0,838.0,10840.0,878.0,10880.0,918.0,936.0,10940.0,10960.0,993.0,11000.0,11020.0,11040.0,1075.0,11080.0,1118.0,11120.0,1154.0,11160.0,1197.0,11200.0,11220.0,1258.0,1277.0,11280.0,1313.0,11320.0,11340.0,11360.0,1397.0,1418.0,1435.0,1453.0,1478.0,1498.0],[10000.0,10020.0,10040.0,10060.0,10080.0,117.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,377.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,637.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,1318.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,1458.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[15.0,35.0,55.0,75.0,95.0,117.0,136.0,157.0,175.0,197.0,216.0,236.0,256.0,276.0,296.0,317.0,336.0,356.0,376.0,396.0,416.0,437.0,456.0,476.0,496.0,516.0,536.0,556.0,576.0,596.0,616.0,637.0,658.0,676.0,696.0,718.0,736.0,756.0,776.0,797.0,816.0,837.0,857.0,876.0,897.0,915.0,936.0,957.0,977.0,996.0,1016.0,1038.0,1056.0,1076.0,1096.0,1116.0,1136.0,1156.0,1177.0,1196.0,1217.0,1236.0,1256.0,1276.0,1296.0,1316.0,1336.0,1356.0,1376.0,1396.0,1416.0,1436.0,1456.0,1475.0,1496.0],[15.0,35.0,55.0,75.0,95.0,117.0,136.0,157.0,175.0,197.0,216.0,236.0,256.0,276.0,296.0,317.0,336.0,356.0,376.0,396.0,416.0,437.0,456.0,476.0,496.0,516.0,536.0,556.0,576.0,596.0,616.0,637.0,658.0,676.0,696.0,718.0,736.0,756.0,776.0,797.0,816.0,837.0,857.0,876.0,897.0,915.0,936.0,957.0,977.0,996.0,1016.0,1038.0,1056.0,1076.0,1096.0,1116.0,1136.0,1156.0,1177.0,1196.0,1217.0,1236.0,1256.0,1276.0,1296.0,1316.0,1336.0,1356.0,1376.0,1396.0,1416.0,1436.0,1456.0,1475.0,1496.0],[18.0,38.0,58.0,78.0,98.0,116.0,137.0,156.0,178.0,196.0,217.0,236.0,257.0,277.0,296.0,316.0,338.0,357.0,377.0,396.0,417.0,436.0,457.0,476.0,497.0,517.0,537.0,557.0,578.0,597.0,617.0,636.0,655.0,676.0,697.0,715.0,737.0,757.0,777.0,796.0,817.0,836.0,856.0,877.0,896.0,918.0,936.0,956.0,976.0,996.0,1017.0,1036.0,1057.0,1077.0,1097.0,1118.0,1136.0,1157.0,1176.0,1197.0,1216.0,1237.0,1257.0,1277.0,1297.0,1317.0,1336.0,1357.0,1376.0,1396.0,1417.0,1436.0,1457.0,1478.0,1496.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,238.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,558.0,10560.0,10580.0,10600.0,10620.0,658.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,1138.0,11140.0,1178.0,11180.0,11200.0,1237.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,1378.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,191.0,10200.0,229.0,250.0,10260.0,10280.0,310.0,10320.0,10340.0,10360.0,10380.0,10400.0,430.0,10440.0,10460.0,10480.0,10500.0,10520.0,549.0,10560.0,10580.0,10600.0,10620.0,649.0,10660.0,691.0,711.0,10720.0,10740.0,10760.0,10780.0,810.0,833.0,851.0,10860.0,891.0,10900.0,10920.0,953.0,970.0,10980.0,1011.0,1033.0,1052.0,11060.0,11080.0,11100.0,1129.0,11140.0,1169.0,11180.0,1211.0,1228.0,11240.0,11260.0,11280.0,11300.0,1332.0,1351.0,1369.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,191.0,10200.0,229.0,250.0,10260.0,10280.0,310.0,10320.0,10340.0,10360.0,10380.0,10400.0,430.0,10440.0,10460.0,10480.0,10500.0,10520.0,549.0,10560.0,10580.0,10600.0,10620.0,649.0,10660.0,691.0,711.0,10720.0,10740.0,10760.0,10780.0,810.0,833.0,851.0,10860.0,891.0,10900.0,10920.0,953.0,970.0,10980.0,1011.0,1033.0,1052.0,11060.0,11080.0,11100.0,1129.0,11140.0,1169.0,11180.0,1211.0,1228.0,11240.0,11260.0,11280.0,11300.0,1332.0,1351.0,1369.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,56.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,191.0,10200.0,233.0,252.0,10260.0,10280.0,312.0,10320.0,10340.0,10360.0,10380.0,10400.0,432.0,10440.0,10460.0,10480.0,10500.0,10520.0,553.0,10560.0,10580.0,10600.0,10620.0,654.0,10660.0,691.0,711.0,10720.0,10740.0,10760.0,10780.0,812.0,829.0,851.0,10860.0,891.0,10900.0,10920.0,949.0,972.0,10980.0,1011.0,1029.0,1050.0,11060.0,11080.0,11100.0,1134.0,11140.0,1173.0,11180.0,1211.0,1235.0,11240.0,11260.0,11280.0,11300.0,1330.0,1351.0,1373.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[16.0,35.0,48.0,78.0,10080.0,10100.0,10120.0,10140.0,174.0,10180.0,218.0,10220.0,10240.0,10260.0,10280.0,10300.0,331.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,578.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,737.0,758.0,10760.0,10780.0,10800.0,838.0,10840.0,877.0,10880.0,10900.0,10920.0,958.0,10960.0,10980.0,11000.0,1038.0,11040.0,1078.0,1097.0,1116.0,11120.0,11140.0,11160.0,1196.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[8.0,29.0,56.0,70.0,10080.0,10100.0,10120.0,158.0,169.0,10180.0,209.0,10220.0,10240.0,273.0,10280.0,10300.0,332.0,10340.0,10360.0,396.0,10400.0,10420.0,457.0,473.0,498.0,511.0,532.0,10540.0,570.0,596.0,615.0,10620.0,10640.0,673.0,10680.0,10700.0,728.0,749.0,776.0,10780.0,10800.0,10820.0,10840.0,869.0,10880.0,916.0,938.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,1070.0,1088.0,1108.0,11120.0,1158.0,11160.0,1188.0,11200.0,11220.0,1256.0,1273.0,1291.0,11300.0,11320.0,11340.0,11360.0,11380.0,1416.0,11420.0,11440.0,1476.0,1494.0],[17.0,37.0,10040.0,73.0,93.0,10100.0,138.0,150.0,178.0,10180.0,214.0,10220.0,10240.0,270.0,292.0,10300.0,10320.0,351.0,10360.0,388.0,411.0,10420.0,448.0,470.0,489.0,512.0,531.0,10540.0,573.0,588.0,609.0,638.0,10640.0,670.0,10680.0,10700.0,736.0,754.0,768.0,791.0,10800.0,10820.0,10840.0,875.0,10880.0,908.0,929.0,10940.0,10960.0,995.0,11000.0,11020.0,11040.0,1073.0,1096.0,1117.0,11120.0,1150.0,11160.0,1197.0,11200.0,11220.0,1248.0,1270.0,1292.0,11300.0,11320.0,11340.0,11360.0,1395.0,1408.0,1432.0,1456.0,1468.0,1489.0],[10000.0,10020.0,10040.0,10060.0,89.0,112.0,129.0,153.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,290.0,10300.0,10320.0,351.0,372.0,396.0,411.0,10420.0,455.0,10460.0,494.0,10500.0,10520.0,10540.0,10560.0,596.0,617.0,629.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,777.0,791.0,10800.0,10820.0,10840.0,10860.0,10880.0,917.0,934.0,10940.0,10960.0,988.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,1153.0,11160.0,11180.0,11200.0,11220.0,1256.0,11260.0,11280.0,1311.0,11320.0,11340.0,11360.0,1388.0,1416.0,1430.0,1448.0,1477.0,1498.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,698.0,10700.0,10720.0,10740.0,10760.0,10780.0,818.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,1238.0,11240.0,11260.0,11280.0,11300.0,11320.0,1358.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[16.0,36.0,56.0,76.0,97.0,118.0,137.0,158.0,176.0,195.0,216.0,235.0,255.0,277.0,298.0,315.0,336.0,357.0,378.0,398.0,418.0,435.0,458.0,477.0,497.0,517.0,536.0,555.0,576.0,597.0,617.0,638.0,655.0,676.0,695.0,715.0,736.0,756.0,777.0,798.0,815.0,835.0,855.0,876.0,895.0,917.0,938.0,955.0,975.0,997.0,1015.0,1035.0,1055.0,1076.0,1096.0,1116.0,1135.0,1158.0,1175.0,1196.0,1215.0,1235.0,1257.0,1276.0,1297.0,1318.0,1335.0,1355.0,1375.0,1398.0,1417.0,1438.0,1457.0,1478.0,1497.0],[16.0,36.0,56.0,76.0,97.0,118.0,137.0,158.0,176.0,195.0,216.0,235.0,255.0,277.0,298.0,315.0,336.0,357.0,378.0,398.0,418.0,435.0,458.0,477.0,497.0,517.0,536.0,555.0,576.0,597.0,617.0,638.0,655.0,676.0,695.0,715.0,736.0,756.0,777.0,798.0,815.0,835.0,855.0,876.0,895.0,917.0,938.0,955.0,975.0,997.0,1015.0,1035.0,1055.0,1076.0,1096.0,1116.0,1135.0,1158.0,1175.0,1196.0,1215.0,1235.0,1257.0,1276.0,1297.0,1318.0,1335.0,1355.0,1375.0,1398.0,1417.0,1438.0,1457.0,1478.0,1497.0],[16.0,37.0,57.0,76.0,96.0,115.0,136.0,155.0,177.0,198.0,216.0,238.0,258.0,276.0,295.0,318.0,337.0,356.0,376.0,396.0,415.0,438.0,455.0,476.0,496.0,516.0,536.0,558.0,577.0,596.0,616.0,636.0,658.0,676.0,698.0,718.0,736.0,756.0,776.0,795.0,818.0,838.0,858.0,877.0,898.0,916.0,935.0,958.0,978.0,996.0,1018.0,1038.0,1058.0,1076.0,1096.0,1117.0,1138.0,1155.0,1178.0,1196.0,1218.0,1238.0,1256.0,1276.0,1296.0,1315.0,1338.0,1358.0,1378.0,1395.0,1416.0,1435.0,1456.0,1476.0,1496.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0],[10000.0,10020.0,10040.0,10060.0,10080.0,10100.0,10120.0,10140.0,10160.0,10180.0,10200.0,10220.0,10240.0,10260.0,10280.0,10300.0,10320.0,10340.0,10360.0,10380.0,10400.0,10420.0,10440.0,10460.0,10480.0,10500.0,10520.0,10540.0,10560.0,10580.0,10600.0,10620.0,10640.0,10660.0,10680.0,10700.0,10720.0,10740.0,10760.0,10780.0,10800.0,10820.0,10840.0,10860.0,10880.0,10900.0,10920.0,10940.0,10960.0,10980.0,11000.0,11020.0,11040.0,11060.0,11080.0,11100.0,11120.0,11140.0,11160.0,11180.0,11200.0,11220.0,11240.0,11260.0,11280.0,11300.0,11320.0,11340.0,11360.0,11380.0,11400.0,11420.0,11440.0,11460.0,11480.0]]
stdp_gmax=7.65136
sim_dur_ff=50.0
#
#

k=0.571/ms/mV
a=0.13
b=-2.714
d=111.506
C=81.2
vR=-60.5*mV
vT=-34.8*mV
vPeak=42.4*mV
c=-60.0*mV
Is=0

model9pEqs= Equations('''
		dV/dt=(k*((V-vR)*(V-vT))-U+I)/(C) : volt
		dU/dt=a*((b*(V-vR)/ms/ms)-(U/ms)) : volt/second
		I : mV/ms
		''')

eqs_stdp='''
dA_pre/dt=-A_pre/tau : 1
dA_post/dt=-A_post/tau : 1
'''

simclock = Clock(dt=dt_*ms)
spikeTimes = [(i, t*ms) for i in xrange(len(spike_times_iter_stdp)) for t in spike_times_iter_stdp[i]]

inputLayer = SpikeGeneratorGroup(nw_arch[0], spikeTimes, clock=simclock)
hiddenLayer = NeuronGroup(nw_arch[1], model=model9pEqs, threshold="V>vPeak", reset="V=c;U+=d", method= "RK", clock=simclock)
outputLayer = NeuronGroup(nw_arch[2], model=model9pEqs, threshold="V>vPeak", reset="V=c;U+=d", method= "RK", clock=simclock)
hiddenLayer.V = vR 
hiddenLayer.U =0
outputLayer.V = vR 
outputLayer.U =0

conn1 = Connection(inputLayer, hiddenLayer, 'V', weight=conn1_init_weight*mV, sparseness=conn1_prob)
conn2 = Connection(hiddenLayer, outputLayer, 'V', weight=conn2_init_weight*mV, sparseness=conn2_prob)
tau = stdp_tau*ms
stdp1=STDP(conn1,eqs=eqs_stdp,pre='A_pre+=stdp1_a_step*mV;w+=A_post',post='A_post+=stdp1_a_step*mV;w+=A_pre',wmax=stdp_gmax*mV, clock=simclock)
stdp2=STDP(conn2,eqs=eqs_stdp,pre='A_pre+=stdp2_a_step*mV;w+=A_post',post='A_post+=stdp2_a_step*mV;w+=A_pre',wmax=stdp_gmax*mV, clock=simclock)
Mpr = PopulationRateMonitor(outputLayer, bin=1*ms)

run(sim_dur_stdp*ms)

#
#
def feed_forward(spikeTimesIterList, ipPatternIdx):
	reinit(states=False)
	spikeTimes = [(i, t*ms) for i in xrange(len(spikeTimesIterList)) for t in spikeTimesIterList[i]]
	inputLayer.spiketimes=spikeTimes
	t1 = time()
	run(sim_dur_ff*ms)
	t2 = time()
	print "#$ip_pattern_idx:", ipPatternIdx
	print "$sim_time:", t2 - t1, "s"
	print "$op_layer_pop_rates:"," ".join(str(p) for p in Mpr.rate)


stdp1 = None
stdp2=None
hiddenLayer.V = vR 
hiddenLayer.U =0
outputLayer.V = vR 
outputLayer.U =0
for i in xrange(0, len(spike_times_iter_ff3d)):
	feed_forward(spikeTimesIterList = spike_times_iter_ff3d[i], ipPatternIdx = ip_pattern_idx[i])
